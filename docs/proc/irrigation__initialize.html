<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="">
    <meta name="author" content="Steve Westenbroek, John Engott, Vic Kelson, Randall Hunt" >
    <link rel="icon" href="../favicon.png">

    <title>irrigation__initialize &ndash; SWB2</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.7.0.slim.min.js" integrity="sha256-tG5mcZUtJsZvyKAxYLVXrmjKBVLd6VpVccqz/r4ypFE=" crossorigin="anonymous"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">SWB2 <small>2.3.1, build </small></a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="..\page\index.html">SWB Overview</a></li>
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/programs.html">Programs</a>
                </li>
            </ul>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>irrigation__initialize
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">
            <li class="list-inline-item" id="meta-license"><i class="fa fa-legal"></i> <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" /></a></li>

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip"
                 data-bs-placement="bottom" data-html="true"
                 title=" 1.0% of total for procedures.">178 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/irrigation.F90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/irrigation.f90.html'>irrigation.F90</a></li>
                <li class="breadcrumb-item"><a href='../module/irrigation~2.html'>irrigation</a></li>
            <li class="breadcrumb-item active" aria-current="page">irrigation__initialize</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-bs-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/irrigation__initialize.html#src">irrigation__initialize</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public  subroutine irrigation__initialize(is_active)  
</h2>
    

    <p>Estimate the irrigation water required to sustain plant growth.</p>
<p>Estimate the irrigation water required in order to
keep soil moisture values above the maximum allowable depletion (MAD)
for each gridcell.</p>
<p>@param[inout] pGrd Pointer to the model grid object
@param[in] pConfig Pointer to the configuration data structure (type T_CONFIG).</p>
<p>determine how many landuse codes are present
determine how many landuse codes are present</p>
<p>retrieve list of fraction of irrigation from groundwater
retrieve maximum allowable depletion
retrieve length (in days since planting) of irrigation
retrieve first day of irrigation
retrieve last day of irrigation
retrieve irrigation efficiency
check: number of irrigation efficiency values == number of landuse codes?
process first day of irrigation. retrieved as a list of strings;
must convert the strings from mm/dd to DOY
process last day of irrigation. retrieved as a list of strings;
must convert the strings from mm/dd to DOY
process number of days of irrigation. retrieved as a list of strings
retrieve application option (i.e. to field capacity, to defined deficit amount, as constant amount)
retrieve application amount. not used if "field capacity" option is active.
value represents deficit fraction or constant amount depending on application option active.
basic checks to see whether the number of parameters equals the number of lu codes</p>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-is_active~3"></span>
              logical(kind=c_bool),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>is_active</strong>(:,:)</td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    <br>


    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="w">  </span><span class="k">subroutine </span><span class="n">irrigation__initialize</span><span class="p">(</span><span class="w"> </span><span class="n">is_active</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="p">(</span><span class="kt">c_bool</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">is_active</span><span class="p">(:,:)</span><span class="w"></span>

<span class="w">    </span><span class="c">! [ LOCALS ]</span>
<span class="w">    </span><span class="k">type</span><span class="w"> </span><span class="p">(</span><span class="n">FSTRING_LIST_T</span><span class="p">)</span><span class="w">              </span><span class="kd">::</span><span class="w"> </span><span class="n">sl_temp_list</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="p">(</span><span class="kt">c_int</span><span class="p">)</span><span class="w">              </span><span class="kd">::</span><span class="w"> </span><span class="n">number_of_landuse_codes</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="p">(</span><span class="kt">c_int</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">landuse_table_codes</span><span class="p">(:)</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="p">(</span><span class="kt">c_int</span><span class="p">)</span><span class="w">              </span><span class="kd">::</span><span class="w"> </span><span class="n">num_records</span><span class="w"></span>
<span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="p">(</span><span class="kt">c_bool</span><span class="p">)</span><span class="w">             </span><span class="kd">::</span><span class="w"> </span><span class="n">are_lengths_unequal</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="p">(</span><span class="kt">c_int</span><span class="p">)</span><span class="w">              </span><span class="kd">::</span><span class="w"> </span><span class="nb">index</span>
<span class="nb">    </span><span class="kt">integer</span><span class="w"> </span><span class="p">(</span><span class="kt">c_int</span><span class="p">)</span><span class="w">              </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="p">(</span><span class="kt">c_int</span><span class="p">)</span><span class="w">              </span><span class="kd">::</span><span class="w"> </span><span class="n">status</span><span class="w"></span>
<span class="w">    </span><span class="kt">character</span><span class="w"> </span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span><span class="w">               </span><span class="kd">::</span><span class="w"> </span><span class="n">str_buffer</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="w"> </span><span class="p">(</span><span class="n">FSTRING_LIST_T</span><span class="p">)</span><span class="w">              </span><span class="kd">::</span><span class="w"> </span><span class="n">sl_irrigation_days</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="w"> </span><span class="p">(</span><span class="n">FSTRING_LIST_T</span><span class="p">)</span><span class="w">              </span><span class="kd">::</span><span class="w"> </span><span class="n">sl_irrigation_begin</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="w"> </span><span class="p">(</span><span class="n">FSTRING_LIST_T</span><span class="p">)</span><span class="w">              </span><span class="kd">::</span><span class="w"> </span><span class="n">sl_irrigation_end</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="w"> </span><span class="p">(</span><span class="n">FSTRING_LIST_T</span><span class="p">)</span><span class="w">              </span><span class="kd">::</span><span class="w"> </span><span class="n">sl_application_method</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="w"> </span><span class="p">(</span><span class="n">FSTRING_LIST_T</span><span class="p">)</span><span class="w">              </span><span class="kd">::</span><span class="w"> </span><span class="n">sl_monthly_irrigation_schedule</span><span class="w"></span>
<span class="w">    </span><span class="kt">character</span><span class="w"> </span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">31</span><span class="p">)</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">temp_str</span><span class="w"></span>

<span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="w"> </span><span class="n">IRRIGATION_FROM_GROUNDWATER</span><span class="p">(</span><span class="w"> </span><span class="nb">count</span><span class="p">(</span><span class="w"> </span><span class="n">is_active</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">status</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">assert</span><span class="p">(</span><span class="w"> </span><span class="n">status</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Failed to allocate memory.&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">FILE__</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">LINE__</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="w"> </span><span class="n">IRRIGATION_FROM_SURFACE_WATER</span><span class="p">(</span><span class="w"> </span><span class="nb">count</span><span class="p">(</span><span class="w"> </span><span class="n">is_active</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">status</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">assert</span><span class="p">(</span><span class="w"> </span><span class="n">status</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Failed to allocate memory.&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">FILE__</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">LINE__</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="c">! create list of possible table headings to look for...</span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="w"> </span><span class="s2">&quot;LU_Code&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="w"> </span><span class="s2">&quot;Landuse_Lookup_Code&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="c">!&gt; determine how many landuse codes are present</span>
<span class="w">    </span><span class="k">call </span><span class="n">PARAMS</span><span class="p">%</span><span class="n">get_parameters</span><span class="p">(</span><span class="w"> </span><span class="n">slKeys</span><span class="o">=</span><span class="n">sl_temp_list</span><span class="p">,</span><span class="w"> </span><span class="n">iValues</span><span class="o">=</span><span class="n">landuse_table_codes</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">number_of_landuse_codes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">count</span><span class="p">(</span><span class="w"> </span><span class="n">landuse_table_codes</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="c">! create list of possible table headings to look for...</span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">clear</span><span class="p">()</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="w"> </span><span class="s2">&quot;Monthly_Irrigation_Schedule&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="w"> </span><span class="s2">&quot;Monthly_Irr_Schedule&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="w"> </span><span class="s2">&quot;Irrigation_Application_Schedule&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="w"> </span><span class="s2">&quot;Monthly_Application_Schedule&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="c">!&gt; determine how many landuse codes are present</span>
<span class="w">    </span><span class="k">call </span><span class="n">PARAMS</span><span class="p">%</span><span class="n">get_parameters</span><span class="p">(</span><span class="w"> </span><span class="n">slKeys</span><span class="o">=</span><span class="n">sl_temp_list</span><span class="p">,</span><span class="w"> </span><span class="n">slValues</span><span class="o">=</span><span class="n">sl_monthly_irrigation_schedule</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="c">!&gt; retrieve list of fraction of irrigation from groundwater</span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">clear</span><span class="p">()</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Fraction_irrigation_from_GW&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Frac_irr_fm_GW&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Fraction_irrigation_from_groundwater&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Frac_irrigation_from_GW&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Fraction_of_irrigation_from_GW&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Fraction_of_irrigation_from_groundwater&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">call </span><span class="n">PARAMS</span><span class="p">%</span><span class="n">get_parameters</span><span class="p">(</span><span class="w"> </span><span class="n">slKeys</span><span class="o">=</span><span class="n">sl_temp_list</span><span class="p">,</span><span class="w"> </span><span class="n">fValues</span><span class="o">=</span><span class="n">FRACTION_OF_IRRIGATION_FROM_GW</span><span class="p">,</span><span class="w"> </span><span class="n">lFatal</span><span class="o">=</span><span class="n">TRUE</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="c">!&gt; retrieve maximum allowable depletion</span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">clear</span><span class="p">()</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Max_allowable_depletion&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Maximum_allowable_depletion&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;MAD&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">call </span><span class="n">PARAMS</span><span class="p">%</span><span class="n">get_parameters</span><span class="p">(</span><span class="w"> </span><span class="n">slKeys</span><span class="o">=</span><span class="n">sl_temp_list</span><span class="p">,</span><span class="w">                            </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                                </span><span class="n">fValues</span><span class="o">=</span><span class="n">MAXIMUM_ALLOWABLE_DEPLETION_FRACTION</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                                </span><span class="n">lFatal</span><span class="o">=</span><span class="n">TRUE</span><span class="w"> </span><span class="p">)</span><span class="w"></span>


<span class="w">    </span><span class="c">!&gt; retrieve length (in days since planting) of irrigation</span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">clear</span><span class="p">()</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Irrigation_length&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Irrigation_days&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Irrigation_days_since_planting&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">call </span><span class="n">PARAMS</span><span class="p">%</span><span class="n">get_parameters</span><span class="p">(</span><span class="w"> </span><span class="n">slKeys</span><span class="o">=</span><span class="n">sl_temp_list</span><span class="p">,</span><span class="w"> </span><span class="n">slValues</span><span class="o">=</span><span class="n">sl_irrigation_days</span><span class="p">,</span><span class="w"> </span><span class="n">lFatal</span><span class="o">=</span><span class="n">FALSE</span><span class="w"> </span><span class="p">)</span><span class="w"></span>


<span class="w">    </span><span class="c">!&gt; retrieve first day of irrigation</span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">clear</span><span class="p">()</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;First_day_of_irrigation&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;First_DOY_irrigation&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Irrigation_start&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Irrigation_start_date&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">call </span><span class="n">PARAMS</span><span class="p">%</span><span class="n">get_parameters</span><span class="p">(</span><span class="w"> </span><span class="n">slKeys</span><span class="o">=</span><span class="n">sl_temp_list</span><span class="p">,</span><span class="w"> </span><span class="n">slValues</span><span class="o">=</span><span class="n">sl_irrigation_begin</span><span class="p">,</span><span class="w"> </span><span class="n">lFatal</span><span class="o">=</span><span class="n">TRUE</span><span class="w"> </span><span class="p">)</span><span class="w"></span>


<span class="w">    </span><span class="c">!&gt; retrieve last day of irrigation</span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">clear</span><span class="p">()</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Last_day_of_irrigation&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Last_DOY_irrigation&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Irrigation_end&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Irrigation_end_date&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">call </span><span class="n">PARAMS</span><span class="p">%</span><span class="n">get_parameters</span><span class="p">(</span><span class="w"> </span><span class="n">slKeys</span><span class="o">=</span><span class="n">sl_temp_list</span><span class="p">,</span><span class="w"> </span><span class="n">slValues</span><span class="o">=</span><span class="n">sl_irrigation_end</span><span class="p">,</span><span class="w"> </span><span class="n">lFatal</span><span class="o">=</span><span class="n">TRUE</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">clear</span><span class="p">()</span><span class="w"></span>


<span class="w">    </span><span class="c">!&gt; retrieve irrigation efficiency</span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">clear</span><span class="p">()</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Irrigation_efficiency&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Irrigation_application_efficiency&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">call </span><span class="n">PARAMS</span><span class="p">%</span><span class="n">get_parameters</span><span class="p">(</span><span class="w"> </span><span class="n">slKeys</span><span class="o">=</span><span class="n">sl_temp_list</span><span class="p">,</span><span class="w">                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                                </span><span class="n">fValues</span><span class="o">=</span><span class="n">IRRIGATION_EFFICIENCY</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                                </span><span class="n">lFatal</span><span class="o">=</span><span class="n">TRUE</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="c">!&gt; check: number of irrigation efficiency values == number of landuse codes?</span>
<span class="w">    </span><span class="n">num_records</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ubound</span><span class="p">(</span><span class="n">IRRIGATION_EFFICIENCY</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">are_lengths_unequal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">num_records</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">number_of_landuse_codes</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">are_lengths_unequal</span><span class="w"> </span><span class="p">)</span><span class="w">                                                             </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">warn</span><span class="p">(</span><span class="w"> </span><span class="n">sMessage</span><span class="o">=</span><span class="s2">&quot;The number of values specifying irrigation application&quot;</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">        </span><span class="o">//</span><span class="s2">&quot; efficiency (&quot;</span><span class="w">                                                                  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">        </span><span class="o">//</span><span class="n">asCharacter</span><span class="p">(</span><span class="w"> </span><span class="n">num_records</span><span class="w"> </span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;) does not match the number of landuse values (&quot;</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">        </span><span class="o">//</span><span class="n">asCharacter</span><span class="p">(</span><span class="w"> </span><span class="n">number_of_landuse_codes</span><span class="w"> </span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;).&quot;</span><span class="p">,</span><span class="w">                                    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">        </span><span class="n">sModule</span><span class="o">=</span><span class="err">__</span><span class="n">FILE__</span><span class="p">,</span><span class="w"> </span><span class="n">iLine</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">lFatal</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="err">_</span><span class="n">c_bool</span><span class="w"> </span><span class="p">)</span><span class="w"></span>


<span class="w">    </span><span class="c">!&gt; process first day of irrigation. retrieved as a list of strings;</span>
<span class="w">    </span><span class="c">!! must convert the strings from mm/dd to DOY</span>
<span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="w"> </span><span class="n">FIRST_DAY_OF_IRRIGATION</span><span class="p">(</span><span class="w"> </span><span class="n">sl_irrigation_begin</span><span class="p">%</span><span class="nb">count</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">status</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">assert</span><span class="p">(</span><span class="w"> </span><span class="n">status</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Problem allocating memory.&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">FILE__</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">LINE__</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">sl_irrigation_begin</span><span class="p">%</span><span class="n">count_matching</span><span class="p">(</span><span class="s2">&quot;&lt;NA&gt;&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">      do </span><span class="nb">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">sl_irrigation_begin</span><span class="p">%</span><span class="nb">count</span>
<span class="nb">        </span><span class="n">str_buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sl_irrigation_begin</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="w"> </span><span class="nb">index</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">scan</span><span class="p">(</span><span class="n">str_buffer</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;/-&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">          </span><span class="n">FIRST_DAY_OF_IRRIGATION</span><span class="p">(</span><span class="w"> </span><span class="nb">index</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mmdd2doy</span><span class="p">(</span><span class="w"> </span><span class="n">str_buffer</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;FIRST_DAY_OF_IRRIGATION&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">else</span>
<span class="k">          </span><span class="n">FIRST_DAY_OF_IRRIGATION</span><span class="p">(</span><span class="w"> </span><span class="nb">index</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">asInt</span><span class="p">(</span><span class="w"> </span><span class="n">str_buffer</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span>
<span class="k">      enddo</span>

<span class="k">    else</span>

<span class="k">      </span><span class="n">FIRST_DAY_OF_IRRIGATION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">90</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;No value was found to define the first day of irrigation.&quot;</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">           </span><span class="n">sHints</span><span class="o">=</span><span class="s2">&quot;Make sure there is a lookup table with the column name &quot;</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">           </span><span class="o">//</span><span class="s2">&quot;&#39;First_day_of_irrigation&#39;.&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lFatal</span><span class="o">=</span><span class="n">TRUE</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span><span class="w"></span>

<span class="w">    </span><span class="c">!&gt; process last day of irrigation. retrieved as a list of strings;</span>
<span class="w">    </span><span class="c">!! must convert the strings from mm/dd to DOY</span>
<span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="w"> </span><span class="n">LAST_DAY_OF_IRRIGATION</span><span class="p">(</span><span class="w"> </span><span class="n">sl_irrigation_end</span><span class="p">%</span><span class="nb">count</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">status</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">assert</span><span class="p">(</span><span class="w"> </span><span class="n">status</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Problem allocating memory.&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">FILE__</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">LINE__</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">sl_irrigation_end</span><span class="p">%</span><span class="n">count_matching</span><span class="p">(</span><span class="s2">&quot;&lt;NA&gt;&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">      do </span><span class="nb">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">sl_irrigation_end</span><span class="p">%</span><span class="nb">count</span>
<span class="nb">        </span><span class="n">str_buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sl_irrigation_end</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="w"> </span><span class="nb">index</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">scan</span><span class="p">(</span><span class="n">str_buffer</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;/-&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">          </span><span class="n">LAST_DAY_OF_IRRIGATION</span><span class="p">(</span><span class="w"> </span><span class="nb">index</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mmdd2doy</span><span class="p">(</span><span class="w"> </span><span class="n">str_buffer</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;LAST_DAY_OF_IRRIGATION&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">else</span>
<span class="k">          </span><span class="n">LAST_DAY_OF_IRRIGATION</span><span class="p">(</span><span class="w"> </span><span class="nb">index</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">asInt</span><span class="p">(</span><span class="w"> </span><span class="n">str_buffer</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">endif</span>
<span class="k">      enddo</span>

<span class="k">    else</span>

<span class="k">      </span><span class="n">LAST_DAY_OF_IRRIGATION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">90</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;No value was found to define the last day of irrigation.&quot;</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">           </span><span class="n">sHints</span><span class="o">=</span><span class="s2">&quot;Make sure there is a lookup table with the column name &quot;</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">           </span><span class="o">//</span><span class="s2">&quot;&#39;Last_day_of_irrigation&#39;.&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lFatal</span><span class="o">=</span><span class="n">TRUE</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">endif</span><span class="w"></span>

<span class="w">    </span><span class="c">!&gt; process number of days of irrigation. retrieved as a list of strings</span>
<span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="w"> </span><span class="n">NUM_DAYS_OF_IRRIGATION</span><span class="p">(</span><span class="w"> </span><span class="n">sl_irrigation_days</span><span class="p">%</span><span class="nb">count</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">status</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">assert</span><span class="p">(</span><span class="w"> </span><span class="n">status</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Problem allocating memory.&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">FILE__</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">LINE__</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">NUM_DAYS_OF_IRRIGATION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sl_irrigation_days</span><span class="p">%</span><span class="n">get_integer</span><span class="p">()</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">sl_irrigation_days</span><span class="p">%</span><span class="n">count_matching</span><span class="p">(</span><span class="s2">&quot;&lt;NA&gt;&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">      where</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">NUM_DAYS_OF_IRRIGATION</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">NUM_DAYS_OF_IRRIGATION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">999999</span><span class="w"></span>
<span class="w">      </span><span class="k">end where</span>

<span class="k">    else</span>

<span class="k">      </span><span class="n">NUM_DAYS_OF_IRRIGATION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">999999</span><span class="w"></span>

<span class="w">    </span><span class="k">endif</span><span class="w"></span>

<span class="w">    </span><span class="c">!&gt; retrieve application option (i.e. to field capacity, to defined deficit amount, as constant amount)</span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">clear</span><span class="p">()</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Irrigation_application_method&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Irrigation_application_scheme&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Irrigation_application_option&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Application_method&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Application_scheme&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Application_option&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">call </span><span class="n">PARAMS</span><span class="p">%</span><span class="n">get_parameters</span><span class="p">(</span><span class="w"> </span><span class="n">slKeys</span><span class="o">=</span><span class="n">sl_temp_list</span><span class="p">,</span><span class="w"> </span><span class="n">slValues</span><span class="o">=</span><span class="n">sl_application_method</span><span class="p">,</span><span class="w"> </span><span class="n">lFatal</span><span class="o">=</span><span class="n">TRUE</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">clear</span><span class="p">()</span><span class="w"></span>

<span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="w"> </span><span class="n">APPLICATION_METHOD_CODE</span><span class="p">(</span><span class="w"> </span><span class="n">sl_application_method</span><span class="p">%</span><span class="nb">count</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">status</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">assert</span><span class="p">(</span><span class="w"> </span><span class="n">status</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Problem allocating memory.&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">FILE__</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">LINE__</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="c">!&gt; retrieve application amount. not used if &quot;field capacity&quot; option is active.</span>
<span class="w">    </span><span class="c">!! value represents deficit fraction or constant amount depending on application option active.</span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">clear</span><span class="p">()</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Application_amount&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Irrigation_amount&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">call </span><span class="n">PARAMS</span><span class="p">%</span><span class="n">get_parameters</span><span class="p">(</span><span class="w"> </span><span class="n">slKeys</span><span class="o">=</span><span class="n">sl_temp_list</span><span class="p">,</span><span class="w"> </span><span class="n">fValues</span><span class="o">=</span><span class="n">APPLICATION_AMOUNT</span><span class="p">,</span><span class="w"> </span><span class="n">lFatal</span><span class="o">=</span><span class="n">TRUE</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">sl_temp_list</span><span class="p">%</span><span class="n">clear</span><span class="p">()</span><span class="w"></span>

<span class="w">    </span><span class="c">!&gt; basic checks to see whether the number of parameters equals the number of lu codes</span>
<span class="w">    </span><span class="n">num_records</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ubound</span><span class="p">(</span><span class="n">FIRST_DAY_OF_IRRIGATION</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">are_lengths_unequal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">num_records</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">number_of_landuse_codes</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">are_lengths_unequal</span><span class="w"> </span><span class="p">)</span><span class="w">                                                            </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">warn</span><span class="p">(</span><span class="w"> </span><span class="n">sMessage</span><span class="o">=</span><span class="s2">&quot;The number of values specifying date of first &quot;</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">        </span><span class="o">//</span><span class="s2">&quot;irrigation application (&quot;</span><span class="w">                                                      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">        </span><span class="o">//</span><span class="n">asCharacter</span><span class="p">(</span><span class="w"> </span><span class="n">num_records</span><span class="w"> </span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;) does not match the number of landuse values (&quot;</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">        </span><span class="o">//</span><span class="n">asCharacter</span><span class="p">(</span><span class="w"> </span><span class="n">number_of_landuse_codes</span><span class="w"> </span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;).&quot;</span><span class="p">,</span><span class="w">                                   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">        </span><span class="n">sModule</span><span class="o">=</span><span class="err">__</span><span class="n">FILE__</span><span class="p">,</span><span class="w"> </span><span class="n">iLine</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">lFatal</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="err">_</span><span class="n">c_bool</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">num_records</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ubound</span><span class="p">(</span><span class="n">LAST_DAY_OF_IRRIGATION</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">are_lengths_unequal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">num_records</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">number_of_landuse_codes</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">are_lengths_unequal</span><span class="w"> </span><span class="p">)</span><span class="w">                                                            </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">warn</span><span class="p">(</span><span class="w"> </span><span class="n">sMessage</span><span class="o">=</span><span class="s2">&quot;The number of values specifying date of last irrigation&quot;</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">        </span><span class="o">//</span><span class="s2">&quot; application (&quot;</span><span class="w">                                                                </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">        </span><span class="o">//</span><span class="n">asCharacter</span><span class="p">(</span><span class="w"> </span><span class="n">num_records</span><span class="w"> </span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;) does not match the number of landuse values (&quot;</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">        </span><span class="o">//</span><span class="n">asCharacter</span><span class="p">(</span><span class="w"> </span><span class="n">number_of_landuse_codes</span><span class="w"> </span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;).&quot;</span><span class="p">,</span><span class="w">                                   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">        </span><span class="n">sModule</span><span class="o">=</span><span class="err">__</span><span class="n">FILE__</span><span class="p">,</span><span class="w"> </span><span class="n">iLine</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">lFatal</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="err">_</span><span class="n">c_bool</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">num_records</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ubound</span><span class="p">(</span><span class="n">FRACTION_OF_IRRIGATION_FROM_GW</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">are_lengths_unequal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">num_records</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">number_of_landuse_codes</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">are_lengths_unequal</span><span class="w"> </span><span class="p">)</span><span class="w">                                                            </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">warn</span><span class="p">(</span><span class="w"> </span><span class="n">sMessage</span><span class="o">=</span><span class="s2">&quot;The number of values specifying the fraction of irrigation&quot;</span><span class="w">    </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">        </span><span class="o">//</span><span class="s2">&quot; from groundwater (&quot;</span><span class="w">                                                           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">        </span><span class="o">//</span><span class="n">asCharacter</span><span class="p">(</span><span class="w"> </span><span class="n">num_records</span><span class="w"> </span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;) does not match the number of landuse values (&quot;</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">        </span><span class="o">//</span><span class="n">asCharacter</span><span class="p">(</span><span class="w"> </span><span class="n">number_of_landuse_codes</span><span class="w"> </span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;).&quot;</span><span class="p">,</span><span class="w">                                   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">        </span><span class="n">sModule</span><span class="o">=</span><span class="err">__</span><span class="n">FILE__</span><span class="p">,</span><span class="w"> </span><span class="n">iLine</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">lFatal</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="err">_</span><span class="n">c_bool</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">num_records</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ubound</span><span class="p">(</span><span class="n">MAXIMUM_ALLOWABLE_DEPLETION_FRACTION</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">are_lengths_unequal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">num_records</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">number_of_landuse_codes</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">are_lengths_unequal</span><span class="w"> </span><span class="p">)</span><span class="w">                                                            </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">warn</span><span class="p">(</span><span class="w"> </span><span class="n">sMessage</span><span class="o">=</span><span class="s2">&quot;The number of values for the maximum allowable depletion &quot;</span><span class="w">     </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">        </span><span class="o">//</span><span class="s2">&quot; fraction (&quot;</span><span class="w">                                                                   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">        </span><span class="o">//</span><span class="n">asCharacter</span><span class="p">(</span><span class="w"> </span><span class="n">num_records</span><span class="w"> </span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;) does not match the number of landuse values (&quot;</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">        </span><span class="o">//</span><span class="n">asCharacter</span><span class="p">(</span><span class="w"> </span><span class="n">number_of_landuse_codes</span><span class="w"> </span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;).&quot;</span><span class="p">,</span><span class="w">                                   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">        </span><span class="n">sModule</span><span class="o">=</span><span class="err">__</span><span class="n">FILE__</span><span class="p">,</span><span class="w"> </span><span class="n">iLine</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">lFatal</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="err">_</span><span class="n">c_bool</span><span class="w"> </span><span class="p">)</span><span class="w"></span>


<span class="w">    </span><span class="n">num_records</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sl_monthly_irrigation_schedule</span><span class="p">%</span><span class="nb">count</span>
<span class="nb">    </span><span class="n">are_lengths_unequal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">num_records</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">number_of_landuse_codes</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="w"> </span><span class="n">MONTHLY_IRRIGATION_SCHEDULE</span><span class="p">(</span><span class="w"> </span><span class="n">number_of_landuse_codes</span><span class="p">,</span><span class="w"> </span><span class="mi">31</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">status</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">call </span><span class="n">assert</span><span class="p">(</span><span class="w"> </span><span class="n">status</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Problem allocating memory&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">are_lengths_unequal</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      call </span><span class="n">warn</span><span class="p">(</span><span class="w"> </span><span class="n">sMessage</span><span class="o">=</span><span class="s2">&quot;The number of values defining monthly irrigation application&quot;</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">        </span><span class="o">//</span><span class="s2">&quot; timing (&quot;</span><span class="o">//</span><span class="n">asCharacter</span><span class="p">(</span><span class="w"> </span><span class="n">num_records</span><span class="w"> </span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;)~does not match the number of&quot;</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">        </span><span class="o">//</span><span class="s2">&quot; landuse codes (&quot;</span><span class="o">//</span><span class="n">asCharacter</span><span class="p">(</span><span class="w"> </span><span class="n">number_of_landuse_codes</span><span class="w"> </span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;). ~Assuming&quot;</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">        </span><span class="o">//</span><span class="s2">&quot; that irrigation is applied *every* day [default].&quot;</span><span class="p">,</span><span class="w">                           </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">        </span><span class="n">sModule</span><span class="o">=</span><span class="err">__</span><span class="n">FILE__</span><span class="p">,</span><span class="w"> </span><span class="n">iLine</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">lEcho</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="err">_</span><span class="n">c_bool</span><span class="p">,</span><span class="w"> </span><span class="n">iLogLevel</span><span class="o">=</span><span class="n">LOG_ALL</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="w">      </span><span class="n">MONTHLY_IRRIGATION_SCHEDULE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_c_int</span><span class="w"></span>

<span class="w">    </span><span class="k">else</span>

<span class="k">      </span><span class="n">MONTHLY_IRRIGATION_SCHEDULE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0_c_int</span><span class="w"></span>

<span class="w">      </span><span class="k">do </span><span class="nb">index</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_landuse_codes</span><span class="w"></span>
<span class="w">        </span><span class="n">temp_str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sl_monthly_irrigation_schedule</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="w"> </span><span class="nb">index</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">is_numeric</span><span class="p">(</span><span class="w"> </span><span class="n">temp_str</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">          do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nb">ubound</span><span class="p">(</span><span class="n">MONTHLY_IRRIGATION_SCHEDULE</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">MONTHLY_IRRIGATION_SCHEDULE</span><span class="p">(</span><span class="w"> </span><span class="nb">index</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">asInt</span><span class="p">(</span><span class="w"> </span><span class="n">temp_str</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">          </span><span class="k">enddo</span>
<span class="k">        endif</span>
<span class="k">      enddo</span>
<span class="k">    endif</span>

<span class="k">    </span><span class="n">num_records</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ubound</span><span class="p">(</span><span class="n">APPLICATION_METHOD_CODE</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">are_lengths_unequal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">num_records</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">number_of_landuse_codes</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">are_lengths_unequal</span><span class="w"> </span><span class="p">)</span><span class="w">                                                            </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">warn</span><span class="p">(</span><span class="w"> </span><span class="n">sMessage</span><span class="o">=</span><span class="s2">&quot;The number of values for the irrigation application option (&quot;</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">        </span><span class="o">//</span><span class="n">asCharacter</span><span class="p">(</span><span class="w"> </span><span class="n">num_records</span><span class="w"> </span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;) does not match the number of landuse values (&quot;</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">        </span><span class="o">//</span><span class="n">asCharacter</span><span class="p">(</span><span class="w"> </span><span class="n">number_of_landuse_codes</span><span class="w"> </span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;).&quot;</span><span class="p">,</span><span class="w">                                   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">        </span><span class="n">sModule</span><span class="o">=</span><span class="err">__</span><span class="n">FILE__</span><span class="p">,</span><span class="w"> </span><span class="n">iLine</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">lFatal</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="err">_</span><span class="n">c_bool</span><span class="w"> </span><span class="p">)</span><span class="w"></span>


<span class="w">    </span><span class="n">num_records</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ubound</span><span class="p">(</span><span class="n">APPLICATION_AMOUNT</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">are_lengths_unequal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">num_records</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">number_of_landuse_codes</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">are_lengths_unequal</span><span class="w"> </span><span class="p">)</span><span class="w">                                                            </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="k">call </span><span class="n">warn</span><span class="p">(</span><span class="w"> </span><span class="n">sMessage</span><span class="o">=</span><span class="s2">&quot;The number of values for the irrigation application amount (&quot;</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">        </span><span class="o">//</span><span class="n">asCharacter</span><span class="p">(</span><span class="w"> </span><span class="n">num_records</span><span class="w"> </span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;) does not match the number of landuse values (&quot;</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">        </span><span class="o">//</span><span class="n">asCharacter</span><span class="p">(</span><span class="w"> </span><span class="n">number_of_landuse_codes</span><span class="w"> </span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;).&quot;</span><span class="p">,</span><span class="w">                                   </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">        </span><span class="n">sModule</span><span class="o">=</span><span class="err">__</span><span class="n">FILE__</span><span class="p">,</span><span class="w"> </span><span class="n">iLine</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">lFatal</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="err">_</span><span class="n">c_bool</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="w">   </span><span class="c">! locate the data structure associated with the gridded irrigation mask entries</span>
<span class="w">    </span><span class="c">! pIRRIGATION_MASK =&gt; DAT%find(&quot;IRRIGATION_MASK&quot;)</span>
<span class="w">    </span><span class="c">! if ( associated(pIRRIGATION_MASK) ) call pIRRIGATION_MASK%getvalues( )</span>

<span class="w">    </span><span class="c">! if ( associated(pIRRIGATION_MASK) ) then</span>

<span class="w">    </span><span class="c">!   irrigation_mask = pack( real(pIRRIGATION_MASK%pGrdBase%iData, c_float), is_active )</span>

<span class="w">    </span><span class="c">! else</span>

<span class="w">    </span><span class="c">!   irrigation_mask = 1.0_c_float</span>

<span class="w">    </span><span class="c">! endif</span>

<span class="w">    </span><span class="k">call </span><span class="n">LOGS</span><span class="p">%</span><span class="k">write</span><span class="p">(</span><span class="s2">&quot; ## Initializing irrigation application rules and application schedules ##&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">iLinesBefore</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">iLinesAfter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iLogLevel</span><span class="o">=</span><span class="n">LOG_ALL</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">do </span><span class="nb">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">sl_application_method</span><span class="p">%</span><span class="nb">count</span>

<span class="nb">      </span><span class="n">str_buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sl_application_method</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="w"> </span><span class="nb">index</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">str_buffer</span><span class="w"> </span><span class="p">.</span><span class="k">contains</span><span class="p">.</span><span class="w"> </span><span class="s2">&quot;capacity&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        </span><span class="n">APPLICATION_METHOD_CODE</span><span class="p">(</span><span class="w"> </span><span class="nb">index</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">APP_FIELD_CAPACITY</span><span class="w"></span>
<span class="w">      </span><span class="n">elseif</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">str_buffer</span><span class="w"> </span><span class="p">.</span><span class="k">contains</span><span class="p">.</span><span class="w"> </span><span class="s2">&quot;deficit&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        </span><span class="n">APPLICATION_METHOD_CODE</span><span class="p">(</span><span class="w"> </span><span class="nb">index</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">APP_DEFINED_DEFICIT</span><span class="w"></span>
<span class="w">      </span><span class="n">elseif</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">str_buffer</span><span class="w"> </span><span class="p">.</span><span class="k">contains</span><span class="p">.</span><span class="w"> </span><span class="s2">&quot;constant&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        </span><span class="n">APPLICATION_METHOD_CODE</span><span class="p">(</span><span class="w"> </span><span class="nb">index</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">APP_CONSTANT_AMOUNT</span><span class="w"></span>
<span class="w">      </span><span class="n">elseif</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">str_buffer</span><span class="w"> </span><span class="p">.</span><span class="k">contains</span><span class="p">.</span><span class="w"> </span><span class="s2">&quot;demand&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        </span><span class="n">APPLICATION_METHOD_CODE</span><span class="p">(</span><span class="w"> </span><span class="nb">index</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">APP_HWB_DEMAND_BASED</span><span class="w"></span>
<span class="w">      </span><span class="k">else</span>
<span class="k">        </span><span class="n">APPLICATION_METHOD_CODE</span><span class="p">(</span><span class="w"> </span><span class="nb">index</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">APP_NONE</span><span class="w"></span>
<span class="w">      </span><span class="k">endif</span>


<span class="k">      call </span><span class="n">LOGS</span><span class="p">%</span><span class="k">write</span><span class="p">(</span><span class="s2">&quot;  landuse &quot;</span><span class="o">//</span><span class="n">asCharacter</span><span class="p">(</span><span class="w"> </span><span class="n">landuse_table_codes</span><span class="p">(</span><span class="w"> </span><span class="nb">index</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;: &quot;</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">        </span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">APP_OPTION_NAME</span><span class="p">(</span><span class="w"> </span><span class="n">APPLICATION_METHOD_CODE</span><span class="p">(</span><span class="w"> </span><span class="nb">index</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">iLogLevel</span><span class="o">=</span><span class="n">LOG_ALL</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">enddo</span>

<span class="k">    </span><span class="n">IRRIGATION_FROM_GROUNDWATER</span><span class="p">(:)</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_c_float</span><span class="w"></span>
<span class="w">    </span><span class="n">IRRIGATION_FROM_SURFACE_WATER</span><span class="p">(:)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_c_float</span><span class="w"></span>

<span class="w">  </span><span class="k">end subroutine </span><span class="n">irrigation__initialize</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col"><p>SWB2 was developed by Steve Westenbroek, John Engott, Vic Kelson, Randall Hunt<br>&copy; 2023 <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" /></a>
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2023-10-17T14:19:59.727997             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>    

    <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


  </body>
</html>